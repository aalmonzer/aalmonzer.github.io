<!doctype html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="styles.css" />
        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
        <script src="js/blog.js"></script>
    </head>
    <body>
        <a href="blog.html" class="back-link">&larr; back to blog</a>

        <div id="post"></div>

        <script>
            async function loadPost() {
                const container = document.getElementById('post');
                const params = new URLSearchParams(window.location.search);
                const slug = params.get('slug');

                if (!slug) {
                    container.innerHTML = '<p style="color: gray;">no post specified. go back.</p>';
                    return;
                }

                const post = await fetchPost(slug);

                if (!post) {
                    container.innerHTML = '<p style="color: gray;">post not found. it might have been a delusion.</p>';
                    return;
                }

                container.innerHTML = `
                    <span class="post-date">${formatDate(post.date)}</span>
                    <h1>${post.title || slug}</h1>
                    <div class="post-body">${marked.parse(post.body)}</div>
                `;
            }

            loadPost();
        </script>
    </body>
</html>
